# Fase 0: Comienzo - Línea Base Pre-Normalizada

## Objetivo

Establecer la estructura base de la base de datos con **denormalización intencional** para propósitos pedagógicos. Esta fase demuestra el estado inicial antes de aplicar principios de normalización, utilizando 3 tablas simples con redundancia intencional de datos que sirve como punto de partida para aprender normalización.

### Propósito Pedagógico

- **Mostrar Problemas**: Redundancia de datos (`nombre_completo`, `tela_nombre`)
- **Baseline Clara**: Punto de comparación para fases normalizadas
- **Simplicidad Intencional**: Fácil de entender, fácil de ver problemas

---

## Esquema de Base de Datos

**Nombre de Base de Datos**: `chamana_db_fase0`  
**Forma Normal**: Pre-normalizado (~1NF parcial - valores mayormente atómicos pero con redundancia)

### Tablas

#### 1. `clientes` (7 columnas)

Información de clientes del e-commerce.

```sql
CREATE TABLE clientes (
    cliente_id SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    telefono VARCHAR(20),
    fecha_registro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    activo BOOLEAN DEFAULT TRUE
);
```

**Características**:

- Simplificada (solo datos de comunicación)
- Sin datos de dirección compleja
- Emails únicos para evitar duplicados

---

#### 2. `categorias` (4 columnas)

Categorías de productos de ropa femenina.

```sql
CREATE TABLE categorias (
    categoria_id SERIAL PRIMARY KEY,
    nombre VARCHAR(50) UNIQUE NOT NULL,
    descripcion TEXT,
    activo BOOLEAN DEFAULT TRUE
);
```

**Categorías Reales**:

1. Buzo
2. Remera
3. Vestido
4. Palazzo
5. Pantalón

---

#### 3. `prendas` (10 columnas) - **Pre-normalizada**

Productos del catálogo CHAMANA.

```sql
CREATE TABLE prendas (
    prenda_id SERIAL PRIMARY KEY,
    nombre_completo VARCHAR(100) NOT NULL,  -- ⚠️ REDUNDANCIA: "Gaia - Jersey Bordó"
    categoria_id INTEGER REFERENCES categorias(categoria_id),
    tela_nombre VARCHAR(100),                -- ⚠️ REDUNDANCIA: Repite telas
    precio_chamana DECIMAL(10,2) NOT NULL,
    precio_arro DECIMAL(10,2),
    descuento_porcentaje DECIMAL(5,2),
    stock INTEGER DEFAULT 0,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    activo BOOLEAN DEFAULT TRUE
);
```

**Problemas Intencionales**:

- `nombre_completo`: Combina diseño + tela (violación de atomicidad)
- `tela_nombre`: Se repite para múltiples productos (redundancia)

**Ejemplo de Datos**:

```
nombre_completo     | tela_nombre       | precio_chamana | stock
--------------------+-------------------+----------------+-------
Gaia - Jersey Bordó | Jersey Bordó      | 40000.00       | 1
Gaia - Plush Verde  | Plush Verde       | 40000.00       | 1
Nube - Frisa Verde  | Frisa Verde       | 40000.00       | 1
```

---

## Cambios Clave desde Inicio del Proyecto

Esta es la **primera fase**, por lo que no hay "cambios desde fase anterior". Los cambios son desde "nada" a:

- ✅ **Estructura Inicial**: 3 tablas (clientes, categorias, prendas)
- ✅ **Redundancia Intencional**: `nombre_completo` combina diseño+tela, `tela_nombre` se repite
- ✅ **Datos Reales**: 31 productos auténticos de CHAMANA cargados
- ✅ **20 Clientes Ficticios**: Para pruebas del sistema
- ✅ **5 Categorías Reales**: Buzo, Remera, Vestido, Palazzo, Pantalón

---

## Resumen de Ejecución

### Proceso de Setup (6 Scripts)

1. **`00_db.js`**: Orquestador maestro que ejecuta todos los scripts en orden
2. **`01_crear_database.js`**: Crea base de datos `chamana_db_fase0`
3. **`02_crear_tablas.js`**: Crea 3 tablas con índices
4. **`03_insertar_categorias.js`**: Inserta 5 categorías reales
5. **`04_insertar_prendas_real.js`**: Inserta 31 productos auténticos CHAMANA
6. **`05_insertar_clientes.js`**: Inserta 20 clientes ficticios
7. **`06_listar_todo.js`**: Verificación y resumen de datos

### Resultados de Ejecución

**Datos Cargados**:

- ✅ 5 categorías
- ✅ 31 prendas (30 + 1 extra)
- ✅ 20 clientes ficticios

**Stock Total**: 45 unidades  
**Precio Promedio**: $33,900  
**Precio Mínimo**: $10,000 (Remeras)  
**Precio Máximo**: $50,000 (Buzos Coral Negro)

**Distribución por Categoría**:

- Buzo: 12 productos (18 unidades)
- Palazzo: 8 productos (10 unidades)
- Remera: 5 productos (9 unidades)
- Pantalón: 4 productos (7 unidades)
- Vestido: 1 producto (1 unidad)

### Log Completo

Ver archivo ejecutado completo en [`.archive/0.comienzo/Ejecucion_fase0.md`](../blob/main/.archive/0.comienzo/Ejecucion_fase0.md)

---

## Lecciones Aprendidas

### Problemas Identificados (Intencionales)

1. **Redundancia de Datos**

   - `tela_nombre` se repite múltiples veces
   - Ejemplo: "Jersey Bordó" aparece en Gaia, Nube, otros diseños
   - **Impacto**: Desperdicio de espacio, riesgo de inconsistencias

2. **Valores No Atómicos**

   - `nombre_completo` combina dos conceptos: Diseño + Tela
   - Dificulta búsquedas por diseño o tela individual
   - **Impacto**: Queries complejos, mantenimiento difícil

3. **Falta de Normalización**
   - No hay tabla independiente para diseños
   - No hay tabla independiente para telas
   - **Impacto**: No se pueden gestionar diseños y telas por separado

### Ventajas Pedagógicas

- ✅ **Simplicidad**: Fácil de entender estructura
- ✅ **Problemas Visibles**: Redundancia obvia para aprender de ella
- ✅ **Baseline Clara**: Punto de comparación para fases normalizadas

---

## Diagramas

- [Diagrama MER Fase 0](../blob/main/diagramas/fase0/01_MER_Fase0.md) - Modelo Conceptual
- [Diagrama DER Fase 0](../blob/main/diagramas/fase0/02_DER_Fase0.md) - Modelo Lógico

---

## Ejemplos de Código

### Query: Obtener Productos por Categoría

```sql
SELECT
    p.nombre_completo,
    p.tela_nombre,
    c.nombre AS categoria,
    p.precio_chamana,
    p.stock
FROM prendas p
JOIN categorias c ON p.categoria_id = c.categoria_id
WHERE c.nombre = 'Buzo'
    AND p.activo = TRUE
ORDER BY p.precio_chamana DESC;
```

### Query: Buscar por Tela (Problemático)

```sql
-- ⚠️ PROBLEMA: Búsqueda por LIKE es ineficiente y propensa a errores
SELECT nombre_completo, tela_nombre, precio_chamana
FROM prendas
WHERE tela_nombre LIKE '%Jersey%';
-- Esto se resolverá en Fase 1 con tabla independiente de telas
```

### Query: Estadísticas de Stock

```sql
SELECT
    c.nombre AS categoria,
    COUNT(p.prenda_id) AS total_productos,
    SUM(p.stock) AS stock_total,
    AVG(p.precio_chamana) AS precio_promedio
FROM prendas p
JOIN categorias c ON p.categoria_id = c.categoria_id
WHERE p.activo = TRUE
GROUP BY c.categoria_id, c.nombre
ORDER BY stock_total DESC;
```

---

## Cómo Ejecutar Esta Fase

### Prerequisitos

- PostgreSQL 15+
- Node.js 18+
- npm

### Setup Completo

```bash
# 1. Navegar a scripts
cd 0.comienzo/database/scripts

# 2. Instalar dependencias
npm install

# 3. Ejecutar script maestro (crea DB + tablas + datos)
node 00_db.js

# 4. Verificar datos
node 06_listar_todo.js
```

### Ejecutar Aplicación Web

```bash
# Desde la raíz de 0.comienzo
cd web

# Instalar dependencias
npm install

# Iniciar servidor
npm start

# Acceder en navegador
# http://localhost:3000
```

### Configuración de Base de Datos

Crear archivo `web/config.env`:

```env
# PostgreSQL Configuration - Fase 0
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=tu_password
DB_NAME=chamana_db_fase0

# Application Configuration
PORT=3000
NODE_ENV=development
```

---

## Próxima Fase

**[Fase 1: Primera Forma Normal (1NF)](2.2.Fase-1-Primera-Forma-Normal)**

### Qué Viene

- ✅ Separar `nombre_completo` en tablas `disenos` y `telas`
- ✅ Eliminar redundancia de `tela_nombre`
- ✅ Crear relaciones claras entre entidades
- ✅ Expansión a 9 tablas (de 3 actuales)
- ✅ Introducir sistema de colecciones estacionales

**Transformación**: 3 tablas pre-normalizadas → 9 tablas en 1NF

---

## Enlaces Relacionados

- [← Volver al Inicio del Wiki](Home)
- [← Visión General del Proyecto](1.Vision-General-Proyecto)
- [→ Siguiente: Fase 1 (1NF)](2.2.Fase-1-Primera-Forma-Normal)
- [📊 Ver Diagramas de Esta Fase](../tree/main/diagramas/fase0)
- [📚 Documentación de Esquemas Completa](3.1.Documentacion-Esquemas)
- [🔄 Guía de Migración a Fase 1](3.2.Guias-Migracion)

---

**Última Actualización**: 23 de Octubre, 2025  
**Estado**: ✅ Completa y funcional  
**Base de Datos**: `chamana_db_fase0`  
**Forma Normal**: Pre-normalizado (~1NF parcial)
